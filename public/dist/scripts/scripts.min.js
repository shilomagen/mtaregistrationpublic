function getTimeRemaining(e){var t=Date.parse(e)-Date.parse(new Date),a=Math.floor(t/1e3%60),r=Math.floor(t/1e3/60%60),i=Math.floor(t/36e5%24),n=Math.floor(t/864e5);return{total:t,days:n,hours:i,minutes:r,seconds:a}}function initializeClock(e,t){function a(){var e=getTimeRemaining(t);i.innerHTML=("0"+e.hours).slice(-2),n.innerHTML=("0"+e.minutes).slice(-2),s.innerHTML=("0"+e.seconds).slice(-2),e.total<=0&&clearInterval(o)}var r=document.getElementById(e),i=(r.querySelector(".days"),r.querySelector(".hours")),n=r.querySelector(".minutes"),s=r.querySelector(".seconds");r.style.display="block",a();var o=setInterval(a,1e3)}$(".role").change(function(){var e=$(this).data("uid");$.ajax({url:"/users/superadmin/"+e,method:"put",data:{role:$(this).find("option:selected").text().trim().toLowerCase()},success:function(e){"ok"===e.status?alert("user changed"):alert("cant update user")},error:function(e){console.log(e.responseText+" :: "+e.statusText)}})}),!function(e){"use strict";function t(t,a){this.itemsArray=[],this.$element=e(t),this.$element.hide(),this.isSelect="SELECT"===t.tagName,this.multiple=this.isSelect&&t.hasAttribute("multiple"),this.objectItems=a&&a.itemValue,this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=e('<div class="bootstrap-tagsinput"></div>'),this.$input=e('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(a)}function a(e,t){if("function"!=typeof e[t]){var a=e[t];e[t]=function(e){return e[a]}}}function r(e,t){if("function"!=typeof e[t]){var a=e[t];e[t]=function(){return a}}}function i(e){return e?l.text(e).html():""}function n(e){var t=0;if(document.selection){e.focus();var a=document.selection.createRange();a.moveStart("character",-e.value.length),t=a.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}function s(t,a){var r=!1;return e.each(a,function(e,a){if("number"==typeof a&&t.which===a)return r=!0,!1;if(t.which===a.which){var i=!a.hasOwnProperty("altKey")||t.altKey===a.altKey,n=!a.hasOwnProperty("shiftKey")||t.shiftKey===a.shiftKey,s=!a.hasOwnProperty("ctrlKey")||t.ctrlKey===a.ctrlKey;if(i&&n&&s)return r=!0,!1}}),r}var o={tagClass:function(e){return"label label-info"},itemValue:function(e){return e?e.toString():e},itemText:function(e){return this.itemValue(e)},itemTitle:function(e){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!0,onTagExists:function(e,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1};t.prototype={constructor:t,add:function(t,a,r){var n=this;if(!(n.options.maxTags&&n.itemsArray.length>=n.options.maxTags)&&(t===!1||t)){if("string"==typeof t&&n.options.trimValue&&(t=e.trim(t)),"object"==typeof t&&!n.objectItems)throw"Can't add objects when itemValue option is not set";if(!t.toString().match(/^\s*$/)){if(n.isSelect&&!n.multiple&&n.itemsArray.length>0&&n.remove(n.itemsArray[0]),"string"==typeof t&&"INPUT"===this.$element[0].tagName){var s=n.options.delimiterRegex?n.options.delimiterRegex:n.options.delimiter,o=t.split(s);if(o.length>1){for(var l=0;l<o.length;l++)this.add(o[l],!0);return void(a||n.pushVal())}}var d=n.options.itemValue(t),u=n.options.itemText(t),c=n.options.tagClass(t),m=n.options.itemTitle(t),p=e.grep(n.itemsArray,function(e){return n.options.itemValue(e)===d})[0];if(!p||n.options.allowDuplicates){if(!(n.items().toString().length+t.length+1>n.options.maxInputLength)){var f=e.Event("beforeItemAdd",{item:t,cancel:!1,options:r});if(n.$element.trigger(f),!f.cancel){n.itemsArray.push(t);var h=e('<span class="tag '+i(c)+(null!==m?'" title="'+m:"")+'">'+i(u)+'<span data-role="remove"></span></span>');if(h.data("item",t),n.findInputWrapper().before(h),h.after(" "),n.isSelect&&!e('option[value="'+encodeURIComponent(d)+'"]',n.$element)[0]){var v=e("<option selected>"+i(u)+"</option>");v.data("item",t),v.attr("value",d),n.$element.append(v)}a||n.pushVal(),(n.options.maxTags===n.itemsArray.length||n.items().toString().length===n.options.maxInputLength)&&n.$container.addClass("bootstrap-tagsinput-max"),n.$element.trigger(e.Event("itemAdded",{item:t,options:r}))}}}else if(n.options.onTagExists){var $=e(".tag",n.$container).filter(function(){return e(this).data("item")===p});n.options.onTagExists(t,$)}}}},remove:function(t,a,r){var i=this;if(i.objectItems&&(t="object"==typeof t?e.grep(i.itemsArray,function(e){return i.options.itemValue(e)==i.options.itemValue(t)}):e.grep(i.itemsArray,function(e){return i.options.itemValue(e)==t}),t=t[t.length-1]),t){var n=e.Event("beforeItemRemove",{item:t,cancel:!1,options:r});if(i.$element.trigger(n),n.cancel)return;e(".tag",i.$container).filter(function(){return e(this).data("item")===t}).remove(),e("option",i.$element).filter(function(){return e(this).data("item")===t}).remove(),-1!==e.inArray(t,i.itemsArray)&&i.itemsArray.splice(e.inArray(t,i.itemsArray),1)}a||i.pushVal(),i.options.maxTags>i.itemsArray.length&&i.$container.removeClass("bootstrap-tagsinput-max"),i.$element.trigger(e.Event("itemRemoved",{item:t,options:r}))},removeAll:function(){var t=this;for(e(".tag",t.$container).remove(),e("option",t.$element).remove();t.itemsArray.length>0;)t.itemsArray.pop();t.pushVal()},refresh:function(){var t=this;e(".tag",t.$container).each(function(){var a=e(this),r=a.data("item"),n=t.options.itemValue(r),s=t.options.itemText(r),o=t.options.tagClass(r);if(a.attr("class",null),a.addClass("tag "+i(o)),a.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=i(s),t.isSelect){var l=e("option",t.$element).filter(function(){return e(this).data("item")===r});l.attr("value",n)}})},items:function(){return this.itemsArray},pushVal:function(){var t=this,a=e.map(t.items(),function(e){return t.options.itemValue(e).toString()});t.$element.val(a,!0).trigger("change")},build:function(t){var i=this;if(i.options=e.extend({},o,t),i.objectItems&&(i.options.freeInput=!1),a(i.options,"itemValue"),a(i.options,"itemText"),r(i.options,"tagClass"),i.options.typeahead){var l=i.options.typeahead||{};r(l,"source"),i.$input.typeahead(e.extend({},l,{source:function(t,a){function r(e){for(var t=[],r=0;r<e.length;r++){var s=i.options.itemText(e[r]);n[s]=e[r],t.push(s)}a(t)}this.map={};var n=this.map,s=l.source(t);e.isFunction(s.success)?s.success(r):e.isFunction(s.then)?s.then(r):e.when(s).then(r)},updater:function(e){return i.add(this.map[e]),this.map[e]},matcher:function(e){return-1!==e.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(e){return e.sort()},highlighter:function(e){var t=new RegExp("("+this.query+")","gi");return e.replace(t,"<strong>$1</strong>")}}))}if(i.options.typeaheadjs){var d=null,u={},c=i.options.typeaheadjs;e.isArray(c)?(d=c[0],u=c[1]):u=c,i.$input.typeahead(d,u).on("typeahead:selected",e.proxy(function(e,t){u.valueKey?i.add(t[u.valueKey]):i.add(t),i.$input.typeahead("val","")},i))}i.$container.on("click",e.proxy(function(e){i.$element.attr("disabled")||i.$input.removeAttr("disabled"),i.$input.focus()},i)),i.options.addOnBlur&&i.options.freeInput&&i.$input.on("focusout",e.proxy(function(t){0===e(".typeahead, .twitter-typeahead",i.$container).length&&(i.add(i.$input.val()),i.$input.val(""))},i)),i.$container.on("keydown","input",e.proxy(function(t){var a=e(t.target),r=i.findInputWrapper();if(i.$element.attr("disabled"))return void i.$input.attr("disabled","disabled");switch(t.which){case 8:if(0===n(a[0])){var s=r.prev();s.length&&i.remove(s.data("item"))}break;case 46:if(0===n(a[0])){var o=r.next();o.length&&i.remove(o.data("item"))}break;case 37:var l=r.prev();0===a.val().length&&l[0]&&(l.before(r),a.focus());break;case 39:var d=r.next();0===a.val().length&&d[0]&&(d.after(r),a.focus())}var u=a.val().length;Math.ceil(u/5),a.attr("size",Math.max(this.inputSize,a.val().length))},i)),i.$container.on("keypress","input",e.proxy(function(t){var a=e(t.target);if(i.$element.attr("disabled"))return void i.$input.attr("disabled","disabled");var r=a.val(),n=i.options.maxChars&&r.length>=i.options.maxChars;i.options.freeInput&&(s(t,i.options.confirmKeys)||n)&&(0!==r.length&&(i.add(n?r.substr(0,i.options.maxChars):r),a.val("")),i.options.cancelConfirmKeysOnEmpty===!1&&t.preventDefault());var o=a.val().length;Math.ceil(o/5),a.attr("size",Math.max(this.inputSize,a.val().length))},i)),i.$container.on("click","[data-role=remove]",e.proxy(function(t){i.$element.attr("disabled")||i.remove(e(t.target).closest(".tag").data("item"))},i)),i.options.itemValue===o.itemValue&&("INPUT"===i.$element[0].tagName?i.add(i.$element.val()):e("option",i.$element).each(function(){i.add(e(this).attr("value"),!0)}))},destroy:function(){var e=this;e.$container.off("keypress","input"),e.$container.off("click","[role=remove]"),e.$container.remove(),e.$element.removeData("tagsinput"),e.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],a=this.$container[0];t&&t.parentNode!==a;)t=t.parentNode;return e(t)}},e.fn.tagsinput=function(a,r,i){var n=[];return this.each(function(){var s=e(this).data("tagsinput");if(s)if(a||r){if(void 0!==s[a]){if(3===s[a].length&&void 0!==i)var o=s[a](r,null,i);else var o=s[a](r);void 0!==o&&n.push(o)}}else n.push(s);else s=new t(this,a),e(this).data("tagsinput",s),n.push(s),"SELECT"===this.tagName&&e("option",e(this)).attr("selected","selected"),e(this).val(e(this).val())}),"string"==typeof a?n.length>1?n:n[0]:n},e.fn.tagsinput.Constructor=t;var l=e("<div />");e(function(){e("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery),$("#form-team-create").on("submit",function(e){e.preventDefault();var t=$("#memberListCreateForm").find("li").toArray(),a=[];t.forEach(function(e){a.push($(e).text())});var r=$(this).serializeObject();a.push(r.admin_email),r.tags={},r.members=a,r.openDate=Date(),""===r.idea&&(r.idea="Not decided yet");var i=$(this).find("#createTeamBtnCreateForm"),n=$("<i />").addClass("fa fa-spinner fa-spin fa-fw");i.text("Creating... ").prepend(n).attr("disabled",!0),$.ajax({type:"POST",cache:!1,contentType:"application/json",url:$(this).attr("action"),data:JSON.stringify(r),success:function(e){var t=$("#registerSuccessModal");t.on("hidden.bs.modal",function(e){window.location.replace("/team-up")}),t.modal("show")},error:function(e){var t=$("#registerFailModal"),a=t.find("#modalFailContent");t.modal("show"),void 0!==e.responseJSON.status?a.text(e.responseJSON.status):a.text("We have a problem. Please try again or contact administrator ASAP")}})}),$("#addMemberCollapse").on("shown.bs.collapse",function(){$(this).siblings("#toggleAddMemberCollapse").text("Cancel and remove members");var e=$("#memberListCreateForm"),t=$("#searchForTeamMembersCreateFormInput");e.empty(),$(this).attr("disabled",!1),t.attr("placeholder","Search for registered user by email"),t.removeClass("form-control-warning"),t.attr("readonly",!1)}),$("#addMemberCollapse").on("hidden.bs.collapse",function(){$(this).siblings("#toggleAddMemberCollapse").text("Add Team Members")}),$("#searchForTeamMembersCreateFormInput").autocomplete({source:function(e,t){$.ajax({url:"/search_member",type:"GET",data:e,success:function(e){t($.map(e,function(e){return{id:e._id,value:e.email}}))}})},minLength:2,focus:function(e,t){this.value=t.item.value,e.preventDefault()},select:function(e,t){this.value=t.item.value,$(this).next("input").val(t.item.value),$(this).data("user",t.item),e.preventDefault()},change:function(e,t){null==t.item&&($("#searchForTeamMembersCreateFormInput").val(""),$("#searchForTeamMembersCreateFormInput").focus())}});var isUserAlreadyOnList=function(e){for(var t=$("#memberListCreateForm").find("li").toArray(),a=0;a<t.length;a++)if($(t[a]).data("user").id===e)return!0;return!1},addMemberToList=function(e){e.preventDefault();var t,a=$("#searchForTeamMembersCreateFormInput"),r=a.data("user"),i=a.data("maxusers"),n=$("#memberListCreateForm");if(!isUserAlreadyOnList(r.id)){var s=$("<li />").data("user",r).text(a.data("user").label).addClass("list-group-item").append($("<button />").attr("type","button").addClass("float-xs-right btn btn-danger btn-sm removeUserFromCreateTeamMembers").click(function(e){e.preventDefault(),$(this).closest("li").remove()}).append($("<i />").addClass("fa fa-times")));n.append(s),t=n.find("li").length,t===i-1&&($(this).attr("disabled",!0),a.attr("placeholder","Max users in a group is "+i+" (including you)"),a.addClass("form-control-warning"),a.attr("readonly",!0))}a.removeData("user"),a.val(""),a.focus()};$("#addMemberToListBtnCreateForm").click(addMemberToList);var initResetPasswordModal=function(){$("#forgotPasswordModal").modal("show")};$("#forgotPasswordResetBtn").click(function(e){e.preventDefault();var t=$("#forgotEmailInput").val();validateEmail(t)?($(this).attr("disabled",!0),$.ajax({url:"/forgot",method:"POST",data:{email:t},success:function(e){switch(e){case"ok":$("#resetSucessMessage").show(),$("#resetErrorMessage").hide();break;case"NOUSER":$("#resetErrorMessageText").text("A user with this email does not exists."),$("#resetErrorMessage").show(),$("#resetSucessMessage").hide();break;default:$("#resetErrorMessageText").text("We have a problem. Please try again or contact administrator ASAP"),$("#resetErrorMessage").show(),$("#resetSucessMessage").hide()}$("#forgotPasswordResetBtn").prop("disabled",!1)},error:function(e){409==e.status?$("#resetErrorMessageText").text("A user with this email already exists.\nThere is no need to register twice.\nFor help, contact Administrator"):$("#resetErrorMessageText").text("We have a problem. Please try again or contact administrator ASAP"),$("#resetErrorMessage").show(),$("#resetSucessMessage").hide(),$("#forgotPasswordResetBtn").prop("disabled",!1)}})):($("#resetErrorMessageText").text("Please enter valid email address"),$("#resetErrorMessage").show(),$("#resetSucessMessage").hide())});var validateEmail=function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)};$("#forgotPasswordModal").on("hidden.bs.modal",function(){$("#resetErrorMessageText").text(""),$("#resetErrorMessageText").hide(),$("#resetSucessMessage").hide(),$("#forgotEmailInput").val("")}),$(function(){var e=function(){var e=$(this),t=$("<i />").addClass("fa fa-spinner fa-spin fa-fw");e.text("Applying...").prepend(t).attr("disabled",!0);var a=$(this).closest("div.card").data("id");$.ajax({method:"POST",url:"/teams/"+a+"/apply",success:function(){location.reload()},error:function(){var e=$("#generalFailModal"),t=e.find("#modalFailContent");e.modal("show"),t.text("We have a problem. Please try again or contact administrator ASAP"),e.on("hidden.bs.modal",function(e){location.reload()})}})};$(".applyTeamBtn").click(e)}),$("#myTeamLeaveBtn").click(function(e){e.preventDefault(),$.ajax({url:"/user/leaveTeam",method:"DELETE",success:function(e){var t=$("#registerSuccessModal");t.on("hidden.bs.modal",function(e){window.location.replace("/mingle")}),t.modal("show")},error:function(e){var t=$("#registerFailModal");t.on("hidden.bs.modal",function(e){window.location.replace("/team-up")}),t.modal("show")}})}),$(document).ready(function(){$("#form-reg").on("submit",function(e){if(e.preventDefault(),$("#reg_but").prop("disabled",!0),$(".reg-loader").css("display","inline-block"),"choose"===$("#form-gender").val()){var t=$("#registerFailModal");t.find("#modalFailContent").text("You forgot to choose gender"),$("#registerFailModal").modal("show"),$("#reg_but").prop("disabled",!1)}else if($("#form-pass-ver").val()!==$("#form-pass").val()){var t=$("#registerFailModal");t.find("#modalFailContent").text("The passwords you inserted does not match, Please fix and try again"),$("#registerFailModal").modal("show"),$("#reg_but").prop("disabled",!1)}else{var a=$("#form-skills").tagsinput("items"),r={};a.forEach(function(e,t){r[t]=e});var i=$(this).serializeObject();i.tags=r,i.regDate=Date(),$.ajax({type:"POST",cache:!1,contentType:"application/json",url:$(this).attr("action"),data:JSON.stringify(i),success:function(e){var t=$("#registerSuccessModal");t.on("hidden.bs.modal",function(e){window.location.replace("/login")}),t.modal("show")},error:function(e){var t=$("#registerFailModal");409==e.status?t.find("#modalFailContent").text("A user with this email already exists."):t.find("#modalFailContent").text("We have a problem. Please try again or contact administrator"),t.modal("show"),$("#reg_but").prop("disabled",!1)}})}}),$("#form-reg").bind("keypress",function(e){if(13==e.keyCode)return!1})}),$(document).ready(function(){var e=$("#registerFailModal");$("#resetPass").on("click",function(){$("#resetPass").prop("disabled",!0),""===$("#username").val()?(e.find("#modalFailContent").text("Please insert an email address"),e.modal("show"),$("#resetPass").prop("disabled",!1)):""===$("#password").val()?(e.find("#modalFailContent").text("Please insert a new password"),e.modal("show"),$("#resetPass").prop("disabled",!1)):$("#password").val()!==$("#password_ver").val()?(e.find("#modalFailContent").text("Passwords do not match"),e.modal("show"),$("#resetPass").prop("disabled",!1)):$.ajax({data:{password:$("#password").val(),email:$("#username").val(),resetPass:$("#reserPass").val()},type:"PUT",url:"/resetme",success:function(e){if("ok"===e){var t=$("#registerSuccessModal");t.modal("show"),t.on("hidden.bs.modal",function(){window.location.replace("/login")}),$("#resetPass").prop("disabled",!1),$("#lastResetText").html("password was reset for "+$("#username").val()+". new password is:"+$("#password").val()),$("#lastReset").css("display","block")}else{var a="";a=void 0===e||"error"!==e?"Something is wrong here. Are you sure it's your email? Please try again or contact administrator for resetting your password":"We have an internal error. Please try again or contact administrator for resetting your password";var r=$("#registerFailModal");r.find("#modalFailContent").text(a),r.modal("show"),$("#resetPass").prop("disabled",!1)}},error:function(e){var t=$("#registerFailModal");t.find("#modalFailContent").text("Please contact administrator for resetting your password"),t.modal("show"),$("#resetPass").prop("disabled",!1)}})})}),jQuery(document).ready(function(){$('.registration-form input[type="text"], .registration-form textarea').on("focus",function(){$(this).removeClass("input-error")}),$(".registration-form").on("submit",function(e){$(this).find('input[type="text"], textarea').each(function(){""==$(this).val()?(e.preventDefault(),$(this).addClass("input-error")):$(this).removeClass("input-error")})}),$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},$("input[name=isAccepted]").click(function(){$("#"+$(this)[0].id).data("email");console.log($(this).is(":checked")),$.ajax({url:"/users/"+$(this).attr("id"),method:"PUT",data:{accepted:$(this).is(":checked")},success:function(e){"ok"===e.status?(alert("user changed"),$(this).attr("checked",$(this).is(":checked"))):alert("cant update user")},error:function(e){console.log(e.responseText+" :: "+e.statusText)}})}),$("input[name=isMember]").click(function(){$.ajax({url:"/users/"+$(this).data("uid"),method:"PUT",data:{isMember:$(this).is(":checked")},success:function(e){"ok"===e.status?(alert("user changed"),$(this).attr("checked",$(this).is(":checked"))):alert("cant update user")},error:function(e){console.log(e.responseText+" :: "+e.statusText)}})})});for(var startDate=new Date("May 16, 2016 11:45:00"),deadline=new Date("May 20, 2016 09:45:00"),schedule=[[startDate,deadline]],i=0;i<schedule.length;i++){var startDate=schedule[i][0],endDate=schedule[i][1],startMs=Date.parse(startDate),endMs=Date.parse(endDate),currentMs=Date.parse(new Date);endMs>currentMs&&currentMs>=startMs&&$.ajax({url:"/timerFlag",success:function(e){console.log(e),"on"===e&&initializeClock("clockdiv",endDate)}})}$(function(){$.fn.serializeObject=function(){var e=this,t={},a={},r={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,t,a){return e[t]=a,e},this.push_counter=function(e){return void 0===a[e]&&(a[e]=0),a[e]++},$.each($(this).serializeArray(),function(){if(r.validate.test(this.name)){for(var a,i=this.name.match(r.key),n=this.value,s=this.name;void 0!==(a=i.pop());)s=s.replace(new RegExp("\\["+a+"\\]$"),""),a.match(r.push)?n=e.build([],e.push_counter(s),n):a.match(r.fixed)?n=e.build([],a,n):a.match(r.named)&&(n=e.build({},a,n));t=$.extend(!0,t,n)}}),t};var e=function(e){var t=$("#generalFailModal"),a=t.find("#modalFailContent");t.modal("show"),a.text("We have a problem. Please try again or contact administrator ASAP")},t=function(e){for(var t=$(".memberResults").find("li").toArray(),a=0;a<t.length;a++)if($(t[a]).data("user").id===e)return!0;return!1},a=function(e){var t=$("#teamMembers").find("li").find("span"),a=[];return t&&t.toArray().forEach(function(e){a.push($(e).text())}),a.push(e),a},r=function(t,a,r){t.preventDefault();var i=$("#teamId").val(),n={userEmail:r,admin_email:$("#team_admin_email").val()};$.ajax({method:a?"POST":"DELETE",url:"teams/"+i+"/approve",data:n,success:function(){location.reload()},error:e})},i=function(t){t.preventDefault();var a=$("#teamId").val(),r={userEmail:$(this).closest("li").find("span").text().trim(),admin_email:$("#team_admin_email").val()};$.ajax({method:"DELETE",url:"teams/"+a+"/member",data:r,success:function(){location.reload()},error:e})},n=function(t){t.preventDefault();var a=$("#searchDialogForm").find("input"),r=a.data("user")?a.data("user").value:a.val(),i=$("#teamId").val(),n={userEmail:r,admin_email:$("#team_admin_email").val()};$.ajax({method:"POST",url:"teams/"+i+"/member",data:n,success:function(){location.reload()},error:e})},s=function(t){t.preventDefault();var r=$(this),i=$("<i />").addClass("fa fa-spinner fa-spin fa-fw");r.text("Updating... ").prepend(i).attr("disabled",!0);var n=$("#updateTeamForm").serializeObject();n.members=a(n.admin_email),"Yes"===n.isClosed?n.isClosed=!1:n.isClosed=!0,n.openDate=Date(),$.ajax({method:"PUT",type:"application/json",url:"/teams/"+n.team_id,data:n,success:function(){var e=$("#generalSuccessModal");e.find(".modal-body p").text("You've updated your team succesfully, mate!"),e.on("hidden.bs.modal",function(e){window.location.replace("/team-up")}),e.modal("show")},error:function(t){e(t),$("#updateGroupBtn").attr("disabled",!1).remove("i").text("Update Team")}})},o=function t(a){a.preventDefault();var t=$(this),r=$("<i />").addClass("fa fa-spinner fa-spin fa-fw");if(t.text("Deleting... ").prepend(r).attr("disabled",!0),window.confirm("Are you sure?")){var i=$("#teamId").val(),n={admin_email:$("#userEmail").val()};$.ajax({method:"DELETE",url:"/teams/"+i,data:n,success:function(e){console.log(e),location.reload()},error:function(t){e(t),$("#deleteGroupBtn").attr("disabled",!1).remove("i").text("Delete Team")}})}},l=$("#searchDialogForm").dialog({autoOpen:!1,height:300,width:500,modal:!0,buttons:{Cancel:function(){l.dialog("close")}},close:function(){console.log("closed")}});$("#searchTeamMembers").on("click",function(){l.dialog("open")}),$("#emailInput").autocomplete({source:function(e,t){$.ajax({url:"/search_member",type:"GET",data:e,success:function(e){t($.map(e,function(e){return{id:e._id,value:e.email}}))}})},minLength:3,focus:function(e,t){this.value=t.item.value,e.preventDefault()},select:function(e,t){this.value=t.item.value,$(this).next("input").val(t.item.value),$(this).data("user",t.item),e.preventDefault()}}),$("#addMemberToListBtn").on("click",function(e){e.preventDefault();var a=$("#searchDialogForm").find("input"),r=a.data("user"),i=$(".memberResults").find("ul");if(!t(r.id)){var n=$("<li />").data("user",r).text(a.data("user").label).addClass("list-group-item");i.append(n)}a.removeData("user"),a.val("")}),$("#updateGroupBtn").click(s),$("#deleteGroupBtn").click(o),$(".approve-user").click(function(e){var t=$(this).closest("li").find("span").text();r(e,!0,t)}),$(".disapprove-user").click(function(e){var t=$(this).closest("li").find("span").text();r(e,!1,t)}),$(".removeUserFromTeam").click(i),$("#addMember").click(n)});